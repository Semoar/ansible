# Generated by ansible, DO NOT MODIFY DIRECTLY

# Enable installed protocols
!include_try /usr/share/dovecot/protocols.d/*.protocol

# Basic configuration
listen = {{ mx_dovecot_imap_listen|join(', ') }}
base_dir = /var/run/dovecot
instance_name = dovecot
login_greeting = {{ mx_dovecot_imap_greeting }}
postmaster_address = postmaster@{{ ansible_domain }}
protocols = "imap{% if mx_dovecot_sieve %} sieve{%- endif %}"
auth_username_format = %Lu

# Logging
#mail_debug = yes
#auth_debug = yes
#auth_verbose = yes

#Â Mail location
mail_location = maildir:~/Maildir
namespace inbox {
    inbox = yes
    location = 
    prefix = 
}

# Authentification
{% if mx_dovecot_passwd %}
auth_mechanisms = plain cram-md5
passdb {
    driver = passwd-file
    args = scheme=cram-md5 {{ mx_dovecot_passwdfile }}
}
{% else %}
auth_mechanisms = plain
passdb {
    driver = pam
}
{% endif %}
{% if mx_tls_enabled %}

# SSL/TLS
ssl = yes
disable_plaintext_auth = yes
ssl_cert = </etc/ssl/certs/dovecot.pem
ssl_key = </etc/ssl/private/dovecot.pem
{% else %}

# No SSL/TLS
ssl = no
disable_plaintext_auth = no
{% endif %}

userdb {
    driver = passwd
    #args = home={{ mx_dovecot_maildirs }} mail=maildir:{{ mx_dovecot_maildirs }}/Maildir
}
{% if mx_dovecot_sieve %}

# Sieve
service managesieve-login {
    inet_listener sieve {
        port = {{ mx_dovecot_managesieveport }}
    }
}

protocol lda {
    mail_plugins = $mail_plugins sieve
}

plugin {
    sieve = ~/.dovecot.sieve
    sieve_dir = ~/.dovecot.sieved
}
{% endif %}
{% if mx_sasl_enabled %}

# SASL
service auth {
    unix_listener /var/spool/postfix/private/auth {
        mode = 0660
        user = postfix
        group = postfix
    }
}
{% endif %}
